[{"path":"http://github-pages.ucl.ac.uk/rmcmc/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 rmcmc authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/articles/barker-proposal.html","id":"example-target-distribution","dir":"Articles","previous_headings":"","what":"Example target distribution","title":"Robust gradient-based MCMC with the Barker proposal","text":"simple example target distribution, consider 10-dimensional Gaussian target heterogeneous scales standard deviation first coordinate 0.01 coordinates 1. rmcmc package expects target distribution specified function evaluating logarithm (potentially unnormalized) probability density point, gradient-based methods Barker proposal, additionally requires specification function evaluating gradient log density function. two functions wrapped list names log_density gradient_log_density respectively.","code":"dimension <- 10 scales <- c(0.01, rep(1, dimension - 1)) target_distribution <- list(   log_density = function(x) -sum((x / scales)^2) / 2,   gradient_log_density = function(x) -x / scales^2 )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/articles/barker-proposal.html","id":"creating-proposal-distribution","dir":"Articles","previous_headings":"","what":"Creating proposal distribution","title":"Robust gradient-based MCMC with the Barker proposal","text":"rmcmc provides implementations several different proposal distributions can used within Metropolis–Hastings based MCMC method: barker_proposal: robust gradient-based Barker proposal proposed Livingstone Zanella (2022). langevin_proposal: gradient-based proposal based discretization Langevin dynamics. random_walk_proposal: Gaussian random-walk proposal. function requires first argument specify target distribution proposal constructed . Optionally additional arguments can used specify scalar scale proposal, vector matrix defining proposal shape routines sample auxiliary variables used proposal. create instance Barker proposal, specifying target distribution arguments left defaults. Rather specifying fixed scale shape tuning parameters, next section illustrate set adaptation parameters warm-stage chains.","code":"proposal <- barker_proposal(target_distribution)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/articles/barker-proposal.html","id":"setting-up-adaptation-of-tuning-parameters","dir":"Articles","previous_headings":"","what":"Setting up adaptation of tuning parameters","title":"Robust gradient-based MCMC with the Barker proposal","text":"rmcmc support adaptively tuning parameters proposal distribution. mediated ‘adapter’ objects define method update parameters proposal based chain state statistics recorded chain iteration. instantiate list adapters () adapt scalar scale proposal distribution coerce average acceptance probability chain transitions target value, (ii) adapt shape proposal distribution per-coordinate scaling factors based estimates coordinate-wise variances target distribution. set initial scale 2.382/(dimension)132.38^2/(\\text{dimension})^{\\frac{1}{3}} following results MALA Roberts Rosenthal (2001), set target acceptance probability 0.4 following guideline Livingstone Zanella (2022). equivalent default behaviour specifying initial_scale target_accept_prob arguments, case proposal dimension dependent values following guidelines Roberts Rosenthal (2001) Livingstone Zanella (2022) used. adapters optional kappa argument can used set decay rate exponent adaptation learning rate. leave default value 0.6 (following recommendation Livingstone Zanella (2022)) cases. adapter updates applied initial set ‘warm-’ chain iterations, proposal parameters remaining fixed final adapted values subsequent set main chain iterations.","code":"adapters <- list(   scale_adapter(     initial_scale = 2.38^2 / dimension^(1 / 3),     target_accept_prob = 0.4   ),   variance_adapter() )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/articles/barker-proposal.html","id":"sampling-a-chain","dir":"Articles","previous_headings":"","what":"Sampling a chain","title":"Robust gradient-based MCMC with the Barker proposal","text":"sample chain first need specify initial chain state. rmcmc package encapsulates chain state list tracks current position chain, also additional quantities auxiliary variables used generate proposed perturbation state, cached values log density gradient computed current position avoid re-computation. chain_state function allows creation list required format, first (required) argument specifying position. Alternatively can directly pass vector specifying just position component state initial_state argument sample_chain. generate initial state position coordinates sampled independent normal distributions standard deviation 10, following example Livingstone Zanella (2022). reproducibility also fix random seed. now everything needed sample Markov chain. use sample_chain function rmcmc. requires us specify target distribution, proposal distribution, initial chain state, number adaptive warm-iterations non-adaptive main chain iterations list adapters use. sample chain 10^{4} warm-10^{4} main chain iterations. set trace_warm_up TRUE record statistics adaptive warm-chain iterations. progress package installed progress bar show chain progress sampling. return value sample_chains list containing fields accessing final chain state (can used start sampling new chain), variables traced main chain iterations additional statistics recorded main chain iterations. trace_warm_up argument sample_chains set TRUE , list returned sample_chains also contain entries warm_up_traces warm_up_statistics corresponding respectively variable traces additional statistics recorded warm-iterations. One additional statistics recorded acceptance probability chain iteration name accept_prob. can therefore compute mean acceptance probability main chain iterations follows: close target acceptance rate 0.4 indicating scale adaptation worked expected. can also inspect shape parameter proposal check variance based shape adaptation succeeded. snippet extracts (first dimensions ) adapted shape proposal object compares known true scales (per-coordinate standard deviations) target distribution. adaptation appears successful adapted shape close true target scales.","code":"set.seed(791285301L) initial_state <- chain_state(10 * rnorm(dimension)) n_warm_up_iteration <- 10000 n_main_iteration <- 10000 barker_results <- sample_chain(   target_distribution = target_distribution,   proposal = proposal,   initial_state = initial_state,   n_warm_up_iteration = n_warm_up_iteration,   n_main_iteration = n_main_iteration,   adapters = adapters,   trace_warm_up = TRUE ) mean_accept_prob <- mean(barker_results$statistics[, \"accept_prob\"]) cat(sprintf(\"Average acceptance probability is %.2f\", mean_accept_prob)) #> Average acceptance probability is 0.39 clipped_dimension <- min(5, dimension) final_shape <- proposal$parameters()$shape cat(   sprintf(\"Adapter scale est.: %s\", toString(final_shape[1:clipped_dimension])),   sprintf(\"True target scales: %s\", toString(scales[1:clipped_dimension])),   sep = \"\\n\" ) #> Adapter scale est.: 0.00903307131812674, 0.883014674313524, 0.871135871141858, 0.865378081822245, 0.84498202947243 #> True target scales: 0.01, 1, 1, 1, 1"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/articles/barker-proposal.html","id":"summarizing-results-using-posterior-package","dir":"Articles","previous_headings":"","what":"Summarizing results using posterior package","title":"Robust gradient-based MCMC with the Barker proposal","text":"output sample_chains can also easily used external packages analyzing MCMC outputs. example posterior package provides implementations various inference diagnostic functions manipulating, subsetting summarizing MCMC outputs. traces entry returned (list) output sample_chain matrix row corresponding chain iterations (named) columns traced variables. matrix can directly coerced draws data format posterior package internally uses represent chain outputs, can passed directly summarize_draws function output tibble data frame containing set summary statistics diagnostic measures variable. can also first explicit convert traces matrix posterior draws object using as_draws_matrix function. can passed summary generic function get equivalent output draws object can also manipulated subsetted various functions provided posterior. example extract_variable function can used extract draws specific named variable. output function can passed various diagnostic functions, example compute effective sample size mean target_log_density variable following","code":"library(posterior) #> This is posterior version 1.6.0 #>  #> Attaching package: 'posterior' #> The following objects are masked from 'package:stats': #>  #>     mad, sd, var #> The following objects are masked from 'package:base': #>  #>     %in%, match summarize_draws(barker_results$traces) #> # A tibble: 11 × 10 #>    variable         mean   median      sd     mad      q5     q95  rhat ess_bulk #>    <chr>           <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <dbl>    <dbl> #>  1 position1     6.54e-6  1.55e-4 0.00906 0.00929 -0.0150  0.0147  1.00    1292. #>  2 position2    -8.88e-3 -2.77e-2 0.870   0.931   -1.41    1.45    1.00    1410. #>  3 position3     8.07e-3 -1.08e-2 0.887   0.944   -1.42    1.43    1.00    1110. #>  4 position4     2.69e-3 -3.03e-3 0.903   0.928   -1.53    1.48    1.00    1244. #>  5 position5     8.94e-3  1.15e-2 0.902   0.923   -1.49    1.47    1.00    1059. #>  6 position6     1.52e-2  2.11e-2 0.883   0.890   -1.46    1.45    1.00    1079. #>  7 position7    -1.43e-2 -1.73e-2 0.883   0.904   -1.45    1.43    1.00    1047. #>  8 position8     1.94e-3 -2.38e-2 0.884   0.910   -1.45    1.44    1.01    1184. #>  9 position9    -4.39e-2 -7.22e-2 0.870   0.879   -1.44    1.37    1.00    1018. #> 10 position10    3.83e-3  3.17e-3 0.920   0.938   -1.47    1.53    1.00    1169. #> 11 target_log_… -3.97e+0 -3.74e+0 1.61    1.46    -6.86   -1.68    1.00     994. #> # ℹ 1 more variable: ess_tail <dbl> draws <- as_draws_matrix(barker_results$traces) summary(draws) #> # A tibble: 11 × 10 #>    variable         mean   median      sd     mad      q5     q95  rhat ess_bulk #>    <chr>           <dbl>    <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <dbl>    <dbl> #>  1 position1     6.54e-6  1.55e-4 0.00906 0.00929 -0.0150  0.0147  1.00    1292. #>  2 position2    -8.88e-3 -2.77e-2 0.870   0.931   -1.41    1.45    1.00    1410. #>  3 position3     8.07e-3 -1.08e-2 0.887   0.944   -1.42    1.43    1.00    1110. #>  4 position4     2.69e-3 -3.03e-3 0.903   0.928   -1.53    1.48    1.00    1244. #>  5 position5     8.94e-3  1.15e-2 0.902   0.923   -1.49    1.47    1.00    1059. #>  6 position6     1.52e-2  2.11e-2 0.883   0.890   -1.46    1.45    1.00    1079. #>  7 position7    -1.43e-2 -1.73e-2 0.883   0.904   -1.45    1.43    1.00    1047. #>  8 position8     1.94e-3 -2.38e-2 0.884   0.910   -1.45    1.44    1.01    1184. #>  9 position9    -4.39e-2 -7.22e-2 0.870   0.879   -1.44    1.37    1.00    1018. #> 10 position10    3.83e-3  3.17e-3 0.920   0.938   -1.47    1.53    1.00    1169. #> 11 target_log_… -3.97e+0 -3.74e+0 1.61    1.46    -6.86   -1.68    1.00     994. #> # ℹ 1 more variable: ess_tail <dbl> cat(   sprintf(     \"Effective sample size of mean(target_log_density) is %.0f\",     ess_mean(extract_variable(draws, \"target_log_density\"))   ) ) #> Effective sample size of mean(target_log_density) is 1058"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/articles/barker-proposal.html","id":"sampling-using-a-langevin-proposal","dir":"Articles","previous_headings":"","what":"Sampling using a Langevin proposal","title":"Robust gradient-based MCMC with the Barker proposal","text":"sample chain using Langevin proposal, can simple use langevin_proposal place baker_proposal. create new set adapters using default arguments scale_adapter set target acceptance rate Langevin proposal specific value 0.574 following results Roberts Rosenthal (2001). can check average acceptance rate main chain iterations close specified target value: use ess_mean function posterior package compute effective sample size mean target_log_density variable","code":"mala_results <- sample_chain(   target_distribution = target_distribution,   proposal = langevin_proposal(target_distribution),   initial_state = initial_state,   n_warm_up_iteration = n_warm_up_iteration,   n_main_iteration = n_main_iteration,   adapters = list(scale_adapter(), variance_adapter()),   trace_warm_up = TRUE ) cat(   sprintf(     \"Average acceptance probability is %.2f\",     mean(mala_results$statistics[, \"accept_prob\"])   ) ) #> Average acceptance probability is 0.60 cat(   sprintf(     \"Effective sample size of mean(target_log_density) is %.0f\",     ess_mean(       extract_variable(         as_draws_matrix(mala_results$traces), \"target_log_density\"       )     )   ) ) #> Effective sample size of mean(target_log_density) is 2877"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/articles/barker-proposal.html","id":"comparing-adaptation-using-barker-and-langevin-proposal","dir":"Articles","previous_headings":"","what":"Comparing adaptation using Barker and Langevin proposal","title":"Robust gradient-based MCMC with the Barker proposal","text":"can plot proposal shape scale parameters varied adaptive warm-iterations, accessing statistics recorded warm_up_statistics entry list returned sample_chain. First considering scalar scale parameter σt\\sigma_t, controlled achieve target average acceptance rate, see Barker proposal adaptation successfully coerces average acceptance rate close 0.4 target value scale parameter adaptation largely stabilized within first 1000 iterations.  Langevin proposal hand, acceptance rate eventually converge target value 0.57, convergence slower evidence unstable oscillatory behaviour adapted scale.  Now consider adaptation diagonal shape matrix Σt\\Sigma_t, based estimates per-coordinate variances. see Barker proposal adaptation quickly converges towards known heterogeneous scales along different coordinates.  Langevin proposal, shape adaptation slower.  can also visualize chain position components warm-iterations using warm_up_traces entry. Barker proposal can see chain quickly appears converge stationary regime  Langevin proposal also appear converge stationary regime convergence slower  Overall see Langevin proposal able achieve higher sampling efficiency tuned appropriate parameters, performance sensitive tuning parameter values resulting less stable robust adaptive tuning.","code":"visualize_scale_adaptation <- function(warm_up_statistics, label) {   n_warm_up_iteration <- nrow(warm_up_statistics)   par(mfrow = c(1, 2))   plot(     exp(warm_up_statistics[, \"log_scale\"]),     type = \"l\",     xlab = expression(paste(\"Chain iteration \", t)),     ylab = expression(paste(\"Scale \", sigma[t]))   )   plot(     cumsum(warm_up_statistics[, \"accept_prob\"]) / 1:n_warm_up_iteration,     type = \"l\",     xlab = expression(paste(\"Chain iteration \", t)),     ylab = expression(paste(\"Average acceptance rate \", alpha[t])),     ylim = c(0, 1)   )   mtext(     sprintf(\"Scale adaptation for %s\", label),     side = 3, line = -2, outer = TRUE   ) } visualize_scale_adaptation(barker_results$warm_up_statistics, \"Barker proposal\") visualize_scale_adaptation(mala_results$warm_up_statistics, \"Langevin proposal\") visualize_shape_adaptation <- function(warm_up_statistics, dimensions, label) {   matplot(     sqrt(warm_up_statistics[, paste0(\"variance_estimate\", dimensions)]),     type = \"l\",     xlab = expression(paste(\"Chain iteration \", t)),     ylab = expression(paste(\"Shape \", diag(Sigma[t]^(1 / 2)))),     log = \"y\"   )   legend(     \"right\",     paste0(\"coordinate \", dimensions),     lty = dimensions,     col = dimensions,     bty = \"n\"   )   mtext(     sprintf(\"Shape adaptation for %s\", label),     side = 3, line = -2, outer = TRUE   ) } visualize_shape_adaptation(   barker_results$warm_up_statistics, 1:clipped_dimension, \"Barker proposal\" ) visualize_shape_adaptation(   mala_results$warm_up_statistics, 1:clipped_dimension, \"Langevin proposal\" ) visualize_traces <- function(traces, dimensions, label) {   matplot(     traces[, paste0(\"position\", dimensions)],     type = \"l\",     xlab = expression(paste(\"Chain iteration \", t)),     ylab = expression(paste(\"Position \", X[t])),   )   legend(     \"topright\",     paste0(\"coordinate \", dimensions),     lty = dimensions,     col = dimensions,     bty = \"n\"   )   mtext(sprintf(\"Traces for %s\", label), side = 3, line = -2, outer = TRUE) } visualize_traces(   barker_results$warm_up_traces, 1:clipped_dimension, \"Barker proposal\" ) visualize_traces(   mala_results$warm_up_traces, 1:clipped_dimension, \"Langevin proposal\" )"},{"path":[]},{"path":"http://github-pages.ucl.ac.uk/rmcmc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew M. Graham. Author, maintainer. Samuel Livingstone. Author. University College London. Copyright holder. Engineering Physical Sciences Research Council. Funder.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Graham MM, Livingstone S (2024). rmcmc: Robust Markov Chain Monte Carlo Methods. R package version 0.0.0.9000, http://github-pages.ucl.ac.uk/rmcmc/, https://github.com/UCL/rmcmc.","code":"@Manual{,   title = {rmcmc: Robust Markov Chain Monte Carlo Methods},   author = {Matthew M. Graham and Samuel Livingstone},   year = {2024},   note = {R package version 0.0.0.9000, http://github-pages.ucl.ac.uk/rmcmc/},   url = {https://github.com/UCL/rmcmc}, }"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/index.html","id":"rmcmc-robust-markov-chain-monte-carlo-methods","dir":"","previous_headings":"","what":"Robust Markov Chain Monte Carlo Methods","title":"Robust Markov Chain Monte Carlo Methods","text":"rmcmc R package simulating Markov chains using Barker proposal compute Markov chain Monte Carlo (MCMC) estimates expectations respect target distribution real-valued vector space. Barker proposal, described Livingstone Zanella (2022) https://doi.org/10.1111/rssb.12482, gradient-based MCMC algorithm inspired Barker accept-reject rule. combines robustness simpler MCMC schemes random-walk Metropolis efficiency gradient-based algorithms Metropolis adjusted Langevin algorithm.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Robust Markov Chain Monte Carlo Methods","text":"can install development version rmcmc like :","code":"# install.packages(\"devtools\") devtools::install_github(\"UCL/rmcmc\")"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Robust Markov Chain Monte Carlo Methods","text":"basic example shows generate samples normal target distribution random scales. Adapters used tune proposal scale achieve target average acceptance probability; tune proposal shape per-dimension scale factors based online estimates target distribution variances.","code":"library(rmcmc)  set.seed(876287L) dimension <- 3 scales <- exp(rnorm(dimension)) target_distribution <- list(   log_density = function(x) -sum((x / scales)^2) / 2,   gradient_log_density = function(x) -x / scales^2 ) proposal <- barker_proposal(target_distribution) results <- sample_chain(   target_distribution = target_distribution,   proposal = proposal,   initial_state = rnorm(dimension),   n_warm_up_iteration = 1000,   n_main_iteration = 1000,   adapters = list(scale_adapter(), variance_adapter()) ) mean_accept_prob <- mean(results$statistics[, \"accept_prob\"]) adapted_shape <- proposal$parameters()$shape cat(   sprintf(\"Average acceptance probability is %.2f\", mean_accept_prob),   sprintf(\"True target scales: %s\", toString(scales)),   sprintf(\"Adapter scale est.: %s\", toString(adapted_shape)),   sep = \"\\n\" ) #> Average acceptance probability is 0.40 #> True target scales: 1.50538046096953, 1.37774732725824, 0.277038897322645 #> Adapter scale est.: 1.35010920408606, 1.5140138215658, 0.248974800274054"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new Barker proposal object. — barker_proposal","title":"Create a new Barker proposal object. — barker_proposal","text":"Returns list function sample proposal, evaluate log density ratio state pair proposal update proposal parameters. proposal two parameters scale shape. least one scale shape must set sampling proposal evaluating log density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new Barker proposal object. — barker_proposal","text":"","code":"barker_proposal(   target_distribution,   scale = NULL,   shape = NULL,   sample_auxiliary = stats::rnorm,   sample_uniform = stats::runif )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new Barker proposal object. — barker_proposal","text":"target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. scale Scale parameter proposal distribution. non-negative scalar value determining scale steps proposed. shape Shape parameter proposal distribution. Either vector corresponding diagonal shape matrix per-dimension scaling factors, matrix allowing arbitrary linear transformations. sample_auxiliary Function generates random vector auxiliary variable distribution. sample_uniform Function generates random vector standard uniform distribution given integer size.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new Barker proposal object. — barker_proposal","text":"Proposal object. list entries sample: function generate sample proposal distribution given current chain state, log_density_ratio:  function compute log density ratio proposal given pair current proposed chain states, update: function update parameters proposal, parameters: function return list current parameter values. default_target_accept_prob: function returning default target acceptance rate use scale adaptation. default_initial_scale: function given dimension gives default value use initial proposal scale parameter.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a new Barker proposal object. — barker_proposal","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   gradient_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution, scale = 1.) state <- chain_state(c(0., 0.)) withr::with_seed(876287L, proposed_state <- proposal$sample(state)) log_density_ratio <- proposal$log_density_ratio(state, proposed_state) proposal$update(scale = 0.5)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a new chain state. — chain_state","title":"Construct a new chain state. — chain_state","text":"chain state object provides cached access target distribution log density gradient.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a new chain state. — chain_state","text":"","code":"chain_state(position, momentum = NULL)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a new chain state. — chain_state","text":"position Position component chain state. momentum Momentum component chain state. Optional.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a new chain state. — chain_state","text":"New chain state object. list entries position: zero-argument function evaluate position vector. momentum: zero-argument function evaluate momentum vector. dimension: zero-argument function evaluate dimension position momentum vectors. update: function accepting arguments position momentum updating value one state components. copy: function creating copy state object including cached values. log_density: function accepting argument target_distribution evaluating log density target distribution current state, caching value avoid recomputation subsequent calls. gradient_log_density: function accepting argument target_distribution evaluating gradient log density target distribution current state, caching value avoid recomputation subsequent calls.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct a new chain state. — chain_state","text":"","code":"state <- chain_state(c(0.1, -0.5)) target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   gradient_log_density = function(x) -x ) state$gradient_log_density(target_distribution) #> [1] -0.1  0.5"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/example_gaussian_stan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct an example BridgeStan StanModel object for a Gaussian model. — example_gaussian_stan_model","title":"Construct an example BridgeStan StanModel object for a Gaussian model. — example_gaussian_stan_model","text":"Requires BridgeStan package installed. Generative model assumed form y ~ normal(mu, sigma) unknown mu sigma.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/example_gaussian_stan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct an example BridgeStan StanModel object for a Gaussian model. — example_gaussian_stan_model","text":"","code":"example_gaussian_stan_model(n_data = 50, seed = 1234L)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/example_gaussian_stan_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct an example BridgeStan StanModel object for a Gaussian model. — example_gaussian_stan_model","text":"n_data Number independent data points y generate condition model . seed Integer seed Stan model.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/example_gaussian_stan_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct an example BridgeStan StanModel object for a Gaussian model. — example_gaussian_stan_model","text":"BridgeStan StanModel object.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/example_gaussian_stan_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct an example BridgeStan StanModel object for a Gaussian model. — example_gaussian_stan_model","text":"","code":"model <- example_gaussian_stan_model(n_data = 5) #> [1] \"BridgeStan not found at location specified by $BRIDGESTAN environment variable, downloading version 2.5.0 to /home/runner/.bridgestan/bridgestan-2.5.0\" #> [1] \"Done!\" model$param_names() #> [1] \"mu\"    \"sigma\""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/involution_langevin.html","id":null,"dir":"Reference","previous_headings":"","what":"Apply involution underlying Langevin proposal to a chain state. — involution_langevin","title":"Apply involution underlying Langevin proposal to a chain state. — involution_langevin","text":"Apply involution underlying Langevin proposal chain state.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/involution_langevin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Apply involution underlying Langevin proposal to a chain state. — involution_langevin","text":"","code":"involution_langevin(state, scale_and_shape, target_distribution)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/involution_langevin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Apply involution underlying Langevin proposal to a chain state. — involution_langevin","text":"target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/involution_langevin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Apply involution underlying Langevin proposal to a chain state. — involution_langevin","text":"Chain state involution applied.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/langevin_proposal.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new Langevin proposal object. — langevin_proposal","title":"Create a new Langevin proposal object. — langevin_proposal","text":"Returns list function sample proposal, evaluate log density ratio state pair proposal update proposal parameters. proposal two parameters scale shape. least one scale shape must set sampling proposal evaluating log density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/langevin_proposal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new Langevin proposal object. — langevin_proposal","text":"","code":"langevin_proposal(   target_distribution,   scale = NULL,   shape = NULL,   sample_auxiliary = stats::rnorm )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/langevin_proposal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new Langevin proposal object. — langevin_proposal","text":"target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. scale Scale parameter proposal distribution. non-negative scalar value determining scale steps proposed. shape Shape parameter proposal distribution. Either vector corresponding diagonal shape matrix per-dimension scaling factors, matrix allowing arbitrary linear transformations. sample_auxiliary Function generates random vector auxiliary variable distribution.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/langevin_proposal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new Langevin proposal object. — langevin_proposal","text":"Proposal object. list entries sample: function generate sample proposal distribution given current chain state, log_density_ratio:  function compute log density ratio proposal given pair current proposed chain states, update: function update parameters proposal, parameters: function return list current parameter values. default_target_accept_prob: function returning default target acceptance rate use scale adaptation. default_initial_scale: function given dimension gives default value use initial proposal scale parameter.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/langevin_proposal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a new Langevin proposal object. — langevin_proposal","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   gradient_log_density = function(x) -x ) proposal <- langevin_proposal(target_distribution, scale = 1.) state <- chain_state(c(0., 0.)) withr::with_seed(876287L, proposed_state <- proposal$sample(state)) log_density_ratio <- proposal$log_density_ratio(state, proposed_state) proposal$update(scale = 0.5)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"Compute logarithm Barker proposal density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"","code":"log_density_ratio_barker(   state,   proposed_state,   target_distribution,   scale_and_shape )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"state Current chain state. proposed_state Proposed chain state. target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. scale_and_shape Scalar, vector matrix scales shapes proposal distribution. scalar (case value non-negative) auxiliary vector isotropically scaled value. vector (case value equal length dimension space entries non-negative) dimension auxiliary vector scaled separately. matrix (case value square matrix size equal dimension space) pre-multiplying auxiliary vector arbitrary linear transformations can performed.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"Logarithm proposal density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_langevin.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute logarithm of Langevin proposal density ratio. — log_density_ratio_langevin","title":"Compute logarithm of Langevin proposal density ratio. — log_density_ratio_langevin","text":"Compute logarithm Langevin proposal density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_langevin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute logarithm of Langevin proposal density ratio. — log_density_ratio_langevin","text":"","code":"log_density_ratio_langevin(   state,   proposed_state,   target_distribution,   scale_and_shape )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_langevin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute logarithm of Langevin proposal density ratio. — log_density_ratio_langevin","text":"state Current chain state. proposed_state Proposed chain state. target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. scale_and_shape Scalar, vector matrix scales shapes proposal distribution. scalar (case value non-negative) auxiliary vector isotropically scaled value. vector (case value equal length dimension space entries non-negative) dimension auxiliary vector scaled separately. matrix (case value square matrix size equal dimension space) pre-multiplying auxiliary vector arbitrary linear transformations can performed.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_langevin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute logarithm of Langevin proposal density ratio. — log_density_ratio_langevin","text":"Logarithm proposal density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/random_walk_proposal.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new random walk proposal object. — random_walk_proposal","title":"Create a new random walk proposal object. — random_walk_proposal","text":"Returns list function sample proposal, evaluate log density ratio state pair proposal update proposal parameters. proposal two parameters scale shape. least one scale shape must set sampling proposal evaluating log density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/random_walk_proposal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new random walk proposal object. — random_walk_proposal","text":"","code":"random_walk_proposal(   target_distribution,   scale = NULL,   shape = NULL,   sample_auxiliary = stats::rnorm )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/random_walk_proposal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new random walk proposal object. — random_walk_proposal","text":"target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. scale Scale parameter proposal distribution. non-negative scalar value determining scale steps proposed. shape Shape parameter proposal distribution. Either vector corresponding diagonal shape matrix per-dimension scaling factors, matrix allowing arbitrary linear transformations. sample_auxiliary Function generates random vector auxiliary variable distribution.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/random_walk_proposal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new random walk proposal object. — random_walk_proposal","text":"Proposal object. list entries sample: function generate sample proposal distribution given current chain state, log_density_ratio:  function compute log density ratio proposal given pair current proposed chain states, update: function update parameters proposal, parameters: function return list current parameter values. default_target_accept_prob: function returning default target acceptance rate use scale adaptation. default_initial_scale: function given dimension gives default value use initial proposal scale parameter.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/random_walk_proposal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a new random walk proposal object. — random_walk_proposal","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2 ) proposal <- random_walk_proposal(target_distribution, scale = 1.) state <- chain_state(c(0., 0.)) withr::with_seed(876287L, proposed_state <- proposal$sample(state)) log_density_ratio <- proposal$log_density_ratio(state, proposed_state) proposal$update(scale = 0.5)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/robust_shape_adapter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create object to adapt proposal shape (and scale) using robust adaptive Metropolis algorithm of Vihola (2012). — robust_shape_adapter","title":"Create object to adapt proposal shape (and scale) using robust adaptive Metropolis algorithm of Vihola (2012). — robust_shape_adapter","text":"Requires ramcmc package installed.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/robust_shape_adapter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create object to adapt proposal shape (and scale) using robust adaptive Metropolis algorithm of Vihola (2012). — robust_shape_adapter","text":"","code":"robust_shape_adapter(   initial_scale = NULL,   target_accept_prob = NULL,   kappa = 0.6 )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/robust_shape_adapter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create object to adapt proposal shape (and scale) using robust adaptive Metropolis algorithm of Vihola (2012). — robust_shape_adapter","text":"initial_scale Initial value use scale parameter. set explicitly proposal dimension dependent default used. target_accept_prob Target value average accept probability chain. set proposal dependent default used. kappa Decay rate exponent [0.5, 1] adaptation learning rate.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/robust_shape_adapter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create object to adapt proposal shape (and scale) using robust adaptive Metropolis algorithm of Vihola (2012). — robust_shape_adapter","text":"List functions entries initialize, function initializing adapter state proposal parameters beginning chain, update function updating adapter state proposal parameters chain iteration, finalize function performing final updates adapter state proposal parameters completion chain sampling (may NULL unused). state zero-argument function accessing current values adapter state variables.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/robust_shape_adapter.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Create object to adapt proposal shape (and scale) using robust adaptive Metropolis algorithm of Vihola (2012). — robust_shape_adapter","text":"Vihola, M. (2012). Robust adaptive Metropolis algorithm coerced acceptance rate. Statistics Computing, 22, 997-1008. https://doi.iorg/10.1007/s11222-011-9269-5","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/robust_shape_adapter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create object to adapt proposal shape (and scale) using robust adaptive Metropolis algorithm of Vihola (2012). — robust_shape_adapter","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   grad_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution) adapter <- robust_shape_adapter(initial_scale = 1., target_accept_prob = 0.4) adapter$initialize(proposal, chain_state(c(0, 0)))"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample new state from Barker proposal. — sample_barker","title":"Sample new state from Barker proposal. — sample_barker","text":"Sample new state Barker proposal.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample new state from Barker proposal. — sample_barker","text":"","code":"sample_barker(   state,   target_distribution,   scale_and_shape,   sample_auxiliary = stats::rnorm,   sample_uniform = stats::runif )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample new state from Barker proposal. — sample_barker","text":"state Current chain state. target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. scale_and_shape Scalar, vector matrix scales shapes proposal distribution. scalar (case value non-negative) auxiliary vector isotropically scaled value. vector (case value equal length dimension space entries non-negative) dimension auxiliary vector scaled separately. matrix (case value square matrix size equal dimension space) pre-multiplying auxiliary vector arbitrary linear transformations can performed. sample_auxiliary Function generates random vector auxiliary variable distribution. sample_uniform Function generates random vector standard uniform distribution given integer size.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample new state from Barker proposal. — sample_barker","text":"Proposed new chain state.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample a Markov chain — sample_chain","title":"Sample a Markov chain — sample_chain","text":"Sample Markov chain using Metropolis-Hastings kernel given proposal target distributions, optionally adapting proposal parameters warm-stage.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample a Markov chain — sample_chain","text":"","code":"sample_chain(   target_distribution,   proposal,   initial_state,   n_warm_up_iteration,   n_main_iteration,   adapters = NULL,   trace_function = NULL,   show_progress_bar = TRUE,   trace_warm_up = FALSE )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample a Markov chain — sample_chain","text":"target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. proposal Proposal distribution object. Must define entries sample, function generate sample proposal distribution given current chain state log_density_ratio, function compute log density ratio proposal given pair current proposed chain states. initial_state Initial chain state. Either vector specifying just position component chain state list output chain_state specifying full chain state. n_warm_up_iteration Number warm-(adaptive) chain iterations run. n_main_iteration Number main (non-adaptive) chain iterations run. adapters List adapters tune proposal parameters warm-. trace_function Function given current chain state outputs list variables trace main (non-adaptive) chain iteration. show_progress_bar Whether show progress bars sampling. Requires progress package installed effect. trace_warm_up Whether record chain traces adaptation / transition statistics (adaptive) warm-iterations addition (non-adaptive) main chain iterations.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample a Markov chain — sample_chain","text":"list entries final_state: final chain state, traces: matrix named columns contained traced variables main chain iteration, variables along columns iterations along rows. statistics: matrix named columns containing transition statistics main chain iteration, statistics along columns iterations along rows. warm_up_traces: matrix named columns contained traced variables warm-chain iteration, variables along columns iterations along rows. present trace_warm_up = TRUE. warm_up_statistics: matrix named columns containing adaptation transition statistics warm-chain iteration, statistics along columns iterations along rows. present trace_warm_up = TRUE.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample a Markov chain — sample_chain","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   gradient_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution, scale = 1.) n_warm_up_iteration <- 1000 n_main_iteration <- 1000 withr::with_seed(876287L, {   initial_state <- chain_state(stats::rnorm(2))   results <- sample_chain(     target_distribution,     proposal,     initial_state,     n_warm_up_iteration,     n_main_iteration   ) })"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_langevin.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample new state from Langevin proposal. — sample_langevin","title":"Sample new state from Langevin proposal. — sample_langevin","text":"Sample new state Langevin proposal.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_langevin.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample new state from Langevin proposal. — sample_langevin","text":"","code":"sample_langevin(   state,   target_distribution,   scale_and_shape,   sample_auxiliary = stats::rnorm )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_langevin.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample new state from Langevin proposal. — sample_langevin","text":"target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. sample_auxiliary Function generates random vector auxiliary variable distribution.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_langevin.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample new state from Langevin proposal. — sample_langevin","text":"Proposal object. list entries sample: function generate sample proposal distribution given current chain state, log_density_ratio:  function compute log density ratio proposal given pair current proposed chain states, update: function update parameters proposal, parameters: function return list current parameter values. default_target_accept_prob: function returning default target acceptance rate use scale adaptation. default_initial_scale: function given dimension gives default value use initial proposal scale parameter.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"Sample Metropolis-Hastings kernel.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"","code":"sample_metropolis_hastings(   state,   target_distribution,   proposal,   sample_uniform = stats::runif )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"state Current chain state. target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. proposal Proposal distribution object. Must define entries sample, function generate sample proposal distribution given current chain state log_density_ratio, function compute log density ratio proposal given pair current proposed chain states. sample_uniform Function generates random vector standard uniform distribution given integer size.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"List named entries state: corresponding new chain state, proposed_state: corresponding proposed chain state, statistics: list named entries statistics transition, consisting named entry accept_prob Metropolis acceptance probability.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_random_walk.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample new state from random walk proposal. — sample_random_walk","title":"Sample new state from random walk proposal. — sample_random_walk","text":"Sample new state random walk proposal.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_random_walk.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample new state from random walk proposal. — sample_random_walk","text":"","code":"sample_random_walk(   state,   target_distribution,   scale_and_shape,   sample_auxiliary = stats::rnorm )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_random_walk.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample new state from random walk proposal. — sample_random_walk","text":"target_distribution Target stationary distribution chain. list named entries log_density gradient_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative gradient_log_density entry value_and_gradient_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value gradient respectively. sample_auxiliary Function generates random vector auxiliary variable distribution.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_random_walk.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample new state from random walk proposal. — sample_random_walk","text":"Proposal object. list entries sample: function generate sample proposal distribution given current chain state, log_density_ratio:  function compute log density ratio proposal given pair current proposed chain states, update: function update parameters proposal, parameters: function return list current parameter values. default_target_accept_prob: function returning default target acceptance rate use scale adaptation. default_initial_scale: function given dimension gives default value use initial proposal scale parameter.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"Create object adapt proposal scale coerce average acceptance rate.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"","code":"scale_adapter(initial_scale = NULL, target_accept_prob = NULL, kappa = 0.6)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"initial_scale Initial value use scale parameter. set explicitly proposal dimension dependent default used. target_accept_prob Target value average accept probability chain. set proposal dependent default used. kappa Decay rate exponent [0.5, 1] adaptation learning rate.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"List functions entries initialize, function initializing adapter state proposal parameters beginning chain, update function updating adapter state proposal parameters chain iteration, finalize function performing final updates adapter state proposal parameters completion chain sampling (may NULL unused). state zero-argument function accessing current values adapter state variables.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   grad_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution) adapter <- scale_adapter(initial_scale = 1., target_accept_prob = 0.4) adapter$initialize(proposal, chain_state(c(0, 0)))"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/target_distribution_from_stan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct target distribution from a BridgeStan StanModel object. — target_distribution_from_stan_model","title":"Construct target distribution from a BridgeStan StanModel object. — target_distribution_from_stan_model","text":"Construct target distribution BridgeStan StanModel object.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/target_distribution_from_stan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct target distribution from a BridgeStan StanModel object. — target_distribution_from_stan_model","text":"","code":"target_distribution_from_stan_model(model)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/target_distribution_from_stan_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct target distribution from a BridgeStan StanModel object. — target_distribution_from_stan_model","text":"model Stan model object use target (posterior) distribution.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/target_distribution_from_stan_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct target distribution from a BridgeStan StanModel object. — target_distribution_from_stan_model","text":"list entries log_density: function evaluate log density function target distribution given current position vector. value_and_gradient_log_density: function evaluate value gradient log density function target distribution given current position vector, returning list entries value gradient.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/target_distribution_from_stan_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct target distribution from a BridgeStan StanModel object. — target_distribution_from_stan_model","text":"","code":"model <- example_gaussian_stan_model() target_distribution <- target_distribution_from_stan_model(model) withr::with_seed(   876287L, state <- chain_state(stats::rnorm(model$param_unc_num())) ) state$log_density(target_distribution) #> [1] -37.48172"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/trace_function_from_stan_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct trace function from a BridgeStan StanModel object. — trace_function_from_stan_model","title":"Construct trace function from a BridgeStan StanModel object. — trace_function_from_stan_model","text":"Construct trace function BridgeStan StanModel object.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/trace_function_from_stan_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct trace function from a BridgeStan StanModel object. — trace_function_from_stan_model","text":"","code":"trace_function_from_stan_model(   model,   include_log_density = TRUE,   include_generated_quantities = FALSE,   include_transformed_parameters = FALSE )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/trace_function_from_stan_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct trace function from a BridgeStan StanModel object. — trace_function_from_stan_model","text":"model Stan model object use generate (constrained) parameters trace. include_log_density Whether include entry log_density corresponding current log density target distribution values returned trace function. include_generated_quantities Whether included generated quantities Stan model definition values returned trace function. include_transformed_parameters Whether include transformed parameters Stan model definition values returned trace function.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/trace_function_from_stan_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct trace function from a BridgeStan StanModel object. — trace_function_from_stan_model","text":"function given chain_state object returns named vector values trace sampling. constrained parameter values model always included.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/trace_function_from_stan_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct trace function from a BridgeStan StanModel object. — trace_function_from_stan_model","text":"","code":"model <- example_gaussian_stan_model() trace_function <- trace_function_from_stan_model(model) withr::with_seed(876287L, state <- chain_state(rnorm(model$param_unc_num()))) trace_function(state) #>           mu        sigma  log_density  #>   -2.4372636    0.9944442 -118.6630971"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"Create object adapt proposal per dimension scales based estimates target distribution variances.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"","code":"variance_adapter(kappa = 0.6)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"kappa Decay rate exponent [0.5, 1] adaptation learning rate.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"List functions entries initialize, function initializing adapter state proposal parameters beginning chain, update function updating adapter state proposal parameters chain iteration, finalize function performing final updates adapter state proposal parameters completion chain sampling (may NULL unused). state zero-argument function accessing current values adapter state variables.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   grad_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution) adapter <- variance_adapter() adapter$initialize(proposal, chain_state(c(0, 0)))"}]
