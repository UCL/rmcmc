[{"path":"http://github-pages.ucl.ac.uk/rmcmc/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 rmcmc authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Matthew M. Graham. Author, maintainer. Samuel Livingstone. Author. University College London. Copyright holder. Engineering Physical Sciences Research Council. Funder.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Graham MM, Livingstone S (2024). rmcmc: Robust Markov Chain Monte Carlo Methods. R package version 0.0.0.9000, http://github-pages.ucl.ac.uk/rmcmc/, https://github.com/UCL/rmcmc.","code":"@Manual{,   title = {rmcmc: Robust Markov Chain Monte Carlo Methods},   author = {Matthew M. Graham and Samuel Livingstone},   year = {2024},   note = {R package version 0.0.0.9000, http://github-pages.ucl.ac.uk/rmcmc/},   url = {https://github.com/UCL/rmcmc}, }"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/index.html","id":"rmcmc-robust-markov-chain-monte-carlo-methods","dir":"","previous_headings":"","what":"Robust Markov Chain Monte Carlo Methods","title":"Robust Markov Chain Monte Carlo Methods","text":"rmcmc R package simulating Markov chains using Barker proposal compute Markov chain Monte Carlo (MCMC) estimates expectations respect target distribution real-valued vector space. Barker proposal, described Livingstone Zanella (2022) https://doi.org/10.1111/rssb.12482, gradient-based MCMC algorithm inspired Barker accept-reject rule. combines robustness simpler MCMC schemes random-walk Metropolis efficiency gradient-based algorithms Metropolis adjusted Langevin algorithm.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Robust Markov Chain Monte Carlo Methods","text":"can install development version rmcmc like :","code":"# install.packages(\"devtools\") devtools::install_github(\"UCL/rmcmc\")"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Robust Markov Chain Monte Carlo Methods","text":"basic example shows generate samples normal target distribution random scales. Adapters used tune proposal scale achieve target average acceptance probability; tune proposal shape per-dimension scale factors based online estimates target distribution variances.","code":"library(rmcmc)  set.seed(876287L) dimension <- 3 scales <- exp(2 * rnorm(dimension)) target_distribution <- list(   log_density = function(x) -sum((x / scales)^2) / 2,   grad_log_density = function(x) -x / scales^2 ) proposal <- barker_proposal(target_distribution) adapters <- list(   scale_adapter(proposal, initial_scale = 1., target_accept_prob = 0.4),   variance_adapter(proposal) ) n_warm_up_iteration <- 1000 n_main_iteration <- 1000 initial_state <- chain_state(rnorm(dimension)) results <- sample_chain(   target_distribution = target_distribution,   proposal = proposal,   initial_state = initial_state,   n_warm_up_iteration = n_warm_up_iteration,   n_main_iteration = n_main_iteration,   adapters = adapters ) mean_accept_prob <- mean(results$statistics$accept_prob) adapted_shape <- proposal$parameters()$shape cat(   sprintf(\"Average acceptance probability is %.2f\", mean_accept_prob),   sprintf(\"True target scales: %s\", toString(scales)),   sprintf(\"Adapter scale est.: %s\", toString(adapted_shape)),   sep = \"\\n\" ) #> Average acceptance probability is 0.46 #> True target scales: 2.26617033226883, 1.89818769776724, 0.0767505506297473 #> Adapter scale est.: 1.77277384748788, 1.71554065105575, 0.0804144979270686"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":null,"dir":"Reference","previous_headings":"","what":"Create a new Barker proposal object. — barker_proposal","title":"Create a new Barker proposal object. — barker_proposal","text":"barker_proposal returns list function sample proposal, evaluate log density ratio state pair proposal update proposal parameters. proposal two parameters scale shape. least one scale shape must set sampling proposal evaluating log density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create a new Barker proposal object. — barker_proposal","text":"","code":"barker_proposal(   target_distribution,   scale = NULL,   shape = NULL,   sample_auxiliary = stats::rnorm,   sample_uniform = stats::runif )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create a new Barker proposal object. — barker_proposal","text":"target_distribution Target stationary distribution chain. list named entries log_density grad_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative grad_log_density entry value_and_grad_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value grad respectively. scale Scale parameter proposal distribution. non-negative scalar value determining scale steps proposed. shape Shape parameter proposal distribution. Either vector corresponding diagonal shape matrix per-dimension scaling factors, matrix allowing arbitrary linear transformations. sample_auxiliary Function generates random vector auxiliary variable distribution. sample_uniform Function generates random vector standard uniform distribution given integer size.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create a new Barker proposal object. — barker_proposal","text":"Proposal object. list entries sample: function generate sample proposal distribution given current chain state, log_density_ratio:  function compute log density ratio proposal given pair current proposed chain states, update: function update parameters proposal, parameters: function return list current parameter values.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/barker_proposal.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create a new Barker proposal object. — barker_proposal","text":"","code":"target_distribution <- list(   log_density = function(x) sum(x^2) / 2,   grad_log_density = function(x) x ) proposal <- barker_proposal(target_distribution, scale = 1.) state <- chain_state(c(0., 0.)) proposed_state <- proposal$sample(state) log_density_ratio <- proposal$log_density_ratio(state, proposed_state) proposal$update(scale = 0.5)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct a new chain state. — chain_state","title":"Construct a new chain state. — chain_state","text":"chain state object provides cached access target distribution log density gradient.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct a new chain state. — chain_state","text":"","code":"chain_state(position, momentum = NULL)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct a new chain state. — chain_state","text":"position Position component chain state. momentum Momentum component chain state. Optional.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct a new chain state. — chain_state","text":"New chain state object. list entries position: zero-argument function evaluate position vector. momentum: zero-argument function evaluate momentum vector. dimension: zero-argument function evaluate dimension position momentum vectors. update: function accepting arguments position momentum updating value one state components. copy: function creating copy state object including cached values. log_density: function accepting argument target_distribution evaluating log density target distribution current state, caching value avoid recomputation subsequent calls. grad_log_density: function accepting argument target_distribution evaluating gradient log density target distribution current state, caching value avoid recomputation subsequent calls.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/chain_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Construct a new chain state. — chain_state","text":"","code":"state <- chain_state(c(0.1, -0.5)) target_distribution <- list(   log_density = function(x) sum(x^2) / 2,   grad_log_density = function(x) x ) state$grad_log_density(target_distribution) #> [1]  0.1 -0.5"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log1p_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Numerically stable computation of log(1 + exp(x)). — log1p_exp","title":"Numerically stable computation of log(1 + exp(x)). — log1p_exp","text":"Numerically stable computation log(1 + exp(x)).","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log1p_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Numerically stable computation of log(1 + exp(x)). — log1p_exp","text":"","code":"log1p_exp(x)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log1p_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Numerically stable computation of log(1 + exp(x)). — log1p_exp","text":"x Scalar vector evaluate function .","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log1p_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Numerically stable computation of log(1 + exp(x)). — log1p_exp","text":"Value log(1 + exp(x))","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"Compute logarithm Barker proposal density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"","code":"log_density_ratio_barker(   state,   proposed_state,   target_distribution,   scale_and_shape )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"state Current chain state. proposed_state Proposed chain state. target_distribution Target stationary distribution chain. list named entries log_density grad_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative grad_log_density entry value_and_grad_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value grad respectively. scale_and_shape Scalar, vector matrix scales shapes proposal distribution. scalar (case value non-negative) auxiliary vector isotropically scaled value. vector (case value equal length dimension space entries non-negative) dimension auxiliary vector scaled separately. matrix (case value square matrix size equal dimension space) pre-multiplying auxiliary vector arbitrary linear transformations can performed.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"Logarithm proposal density ratio.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/log_density_ratio_barker.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute logarithm of Barker proposal density ratio. — log_density_ratio_barker","text":"","code":"state <- chain_state(c(0., 0.)) target_distribution <- list(   log_density = function(x) sum(x^2) / 2,   grad_log_density = function(x) x ) scale_and_shape <- 1. proposed_state <- sample_barker(state, target_distribution, scale_and_shape) log_density_ratio_barker(   state, proposed_state, target_distribution, scale_and_shape ) #> [1] 0"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/logistic_sigmoid.html","id":null,"dir":"Reference","previous_headings":"","what":"Logistic sigmoid function 1 / (1 + exp(-x)). — logistic_sigmoid","title":"Logistic sigmoid function 1 / (1 + exp(-x)). — logistic_sigmoid","text":"Logistic sigmoid function 1 / (1 + exp(-x)).","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/logistic_sigmoid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logistic sigmoid function 1 / (1 + exp(-x)). — logistic_sigmoid","text":"","code":"logistic_sigmoid(x)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/logistic_sigmoid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logistic sigmoid function 1 / (1 + exp(-x)). — logistic_sigmoid","text":"x Scalar vector evaluate logistic sigmoid .","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/logistic_sigmoid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logistic sigmoid function 1 / (1 + exp(-x)). — logistic_sigmoid","text":"Value logistic sigmoid x.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/min_1_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Numerically stable computation of min(1, exp(x)). — min_1_exp","title":"Numerically stable computation of min(1, exp(x)). — min_1_exp","text":"Numerically stable computation min(1, exp(x)).","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/min_1_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Numerically stable computation of min(1, exp(x)). — min_1_exp","text":"","code":"min_1_exp(x)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/min_1_exp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Numerically stable computation of min(1, exp(x)). — min_1_exp","text":"x Scalar vector evaluate function .","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/min_1_exp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Numerically stable computation of min(1, exp(x)). — min_1_exp","text":"Value min(1, exp(x))","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample new state from Barker proposal. — sample_barker","title":"Sample new state from Barker proposal. — sample_barker","text":"Sample new state Barker proposal.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample new state from Barker proposal. — sample_barker","text":"","code":"sample_barker(   state,   target_distribution,   scale_and_shape,   sample_auxiliary = stats::rnorm,   sample_uniform = stats::runif )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample new state from Barker proposal. — sample_barker","text":"state Current chain state. target_distribution Target stationary distribution chain. list named entries log_density grad_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative grad_log_density entry value_and_grad_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value grad respectively. scale_and_shape Scalar, vector matrix scales shapes proposal distribution. scalar (case value non-negative) auxiliary vector isotropically scaled value. vector (case value equal length dimension space entries non-negative) dimension auxiliary vector scaled separately. matrix (case value square matrix size equal dimension space) pre-multiplying auxiliary vector arbitrary linear transformations can performed. sample_auxiliary Function generates random vector auxiliary variable distribution. sample_uniform Function generates random vector standard uniform distribution given integer size.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample new state from Barker proposal. — sample_barker","text":"Proposed new chain state.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_barker.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample new state from Barker proposal. — sample_barker","text":"","code":"state <- chain_state(c(0., 0.)) target_distribution <- list(   log_density = function(x) sum(x^2) / 2,   grad_log_density = function(x) x ) sample_barker(state, target_distribution, scale_and_shape = 1.) #> $position #> function ()  #> position #> <bytecode: 0x562ec3b336d0> #> <environment: 0x562ec9e84c60> #>  #> $momentum #> function ()  #> momentum #> <bytecode: 0x562ec3b33580> #> <environment: 0x562ec9e84c60> #>  #> $dimension #> function ()  #> length(position) #> <bytecode: 0x562ec3b33430> #> <environment: 0x562ec9e84c60> #>  #> $update #> function (position = NULL, momentum = NULL)  #> { #>     if (!is.null(position)) { #>         position <<- position #>         cached_log_density <<- NULL #>         cached_grad_log_density <<- NULL #>     } #>     if (!is.null(momentum)) { #>         momentum <<- momentum #>     } #> } #> <bytecode: 0x562ec3b33ee8> #> <environment: 0x562ec9e84c60> #>  #> $copy #> function ()  #> { #>     new_chain_state(position, momentum, cached_log_density, cached_grad_log_density) #> } #> <bytecode: 0x562ec3b33350> #> <environment: 0x562ec9e84c60> #>  #> $log_density #> function (target_distribution)  #> { #>     if (is.null(cached_log_density)) { #>         cached_log_density <<- target_distribution$log_density(position) #>     } #>     cached_log_density #> } #> <bytecode: 0x562ec3b31318> #> <environment: 0x562ec9e84c60> #>  #> $grad_log_density #> function (target_distribution)  #> { #>     if (is.null(cached_grad_log_density)) { #>         if (\"value_and_grad_log_density\" %in% target_distribution) { #>             value_and_grad <- target_distribution$value_and_grad_log_density(position) #>             cached_log_density <<- value_and_grad$value #>             cached_grad_log_density <<- value_and_grad$grad #>         } #>         else { #>             cached_grad_log_density <<- target_distribution$grad_log_density(position) #>         } #>     } #>     cached_grad_log_density #> } #> <bytecode: 0x562ec3b30e10> #> <environment: 0x562ec9e84c60> #>"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample a Markov chain — sample_chain","title":"Sample a Markov chain — sample_chain","text":"Sample Markov chain using Metropolis-Hastings kernel given proposal target distributions, optionally adapting proposal parameters warm-stage.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample a Markov chain — sample_chain","text":"","code":"sample_chain(   target_distribution,   proposal,   initial_state,   n_warm_up_iteration,   n_main_iteration,   adapters = NULL,   trace_function = NULL,   seed = NULL,   show_progress_bar = TRUE )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample a Markov chain — sample_chain","text":"target_distribution Target stationary distribution chain. list named entries log_density grad_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative grad_log_density entry value_and_grad_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value grad respectively. proposal Proposal distribution object. Must define entries sample, function generate sample proposal distribution given current chain state log_density_ratio, function compute log density ratio proposal given pair current proposed chain states. initial_state Initial chain state. n_warm_up_iteration Number warm-(adaptive) chain iterations run. n_main_iteration Number main (non-adaptive) chain iterations run. adapters List adapters tune proposal parameters warm-. trace_function Function given current chain state outputs list variables trace main (non-adaptive) chain iteration. seed Integer value seed pseudo-random number generator . show_progress_bar Whether show progress bars sampling. Requires progress package installed effect.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample a Markov chain — sample_chain","text":"list entries final_state: final chain state, traces: dataframe contained traced variables main chain iteration, variables along columns iterations along rows. statistics: dataframe containing transition statistics main chain iteration, statistics along columns iterations along rows.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_chain.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample a Markov chain — sample_chain","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   grad_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution, scale = 1.) n_warm_up_iteration <- 1000 n_main_iteration <- 100 initial_state <- chain_state(rnorm(2)) results <- sample_chain(   target_distribution,   proposal,   initial_state,   n_warm_up_iteration,   n_main_iteration )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"Sample Metropolis-Hastings kernel.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"","code":"sample_metropolis_hastings(   state,   target_distribution,   proposal,   sample_uniform = stats::runif )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"state Current chain state. target_distribution Target stationary distribution chain. list named entries log_density grad_log_density corresponding respectively functions evaluating logarithm (potentially unnormalized) density target distribution gradient. alternative grad_log_density entry value_and_grad_log_density may instead provided function returning value gradient logarithm (unnormalized) density target distribution list names value grad respectively. proposal Proposal distribution object. Must define entries sample, function generate sample proposal distribution given current chain state log_density_ratio, function compute log density ratio proposal given pair current proposed chain states. sample_uniform Function generates random vector standard uniform distribution given integer size.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"List named entries state: corresponding new chain state, statistics: list named entries statistics transition, consisting named entry accept_prob Metropolis acceptance probability.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/sample_metropolis_hastings.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Sample from Metropolis-Hastings kernel. — sample_metropolis_hastings","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   grad_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution, scale = 1.) state <- chain_state(rnorm(2)) new_state_and_statistics <- sample_metropolis_hastings(   state, target_distribution, proposal )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"Create object adapt proposal scale coerce average acceptance rate.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"","code":"scale_adapter(proposal, initial_scale, target_accept_prob = 0.4, kappa = 0.6)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"proposal Proposal object adapt. Must define update function accepts parameter scale setting scale parameter proposal. initial_scale Initial value use scale parameter. target_accept_prob Target value average accept probability chain. kappa Decay rate exponent [0.5, 1] adaptation learning rate.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"List functions entries initialize, function initializing adapter state beginning chain, update function updating adapter state proposal parameters chain iteration, finalize function performing final updates adapter state proposal parameters completion chain sampling (may NULL unused).","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/scale_adapter.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create object to adapt proposal scale to coerce average acceptance rate. — scale_adapter","text":"","code":"target_distribution <- list(   log_density = function(x) -sum(x^2) / 2,   grad_log_density = function(x) -x ) proposal <- barker_proposal(target_distribution) adapter <- scale_adapter(   proposal,   initial_scale = 1., target_accept_prob = 0.4 )"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":null,"dir":"Reference","previous_headings":"","what":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"Create object adapt proposal per dimension scales based estimates target distribution variances.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"","code":"variance_adapter(proposal, kappa = 0.6)"},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"proposal Proposal object adapt. Must define update function accepts parameter shape setting shape parameter proposal. kappa Decay rate exponent [0.5, 1] adaptation learning rate.","code":""},{"path":"http://github-pages.ucl.ac.uk/rmcmc/reference/variance_adapter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create object to adapt proposal with per dimension scales based on estimates of target distribution variances. — variance_adapter","text":"List functions entries initialize, function initializing adapter state beginning chain, update function updating adapter state proposal parameters chain iteration, finalize function performing final updates adapter state proposal parameters completion chain sampling (may NULL unused).","code":""}]
